import{J as w,x as k,j as e,S as o}from"./app-BaknNhqj.js";import{N as b}from"./NavBar-Dej-FWgs.js";import{H as B}from"./Head-DpxRcjdG.js";import{C as f,R as _,a as j,A as v}from"./Alert-CONlK0ny.js";import{T as N}from"./Table-B86M5i0G.js";import{P as A,a,b as d}from"./PaginationLink-CZfl65vk.js";import{F as $}from"./Filter-cVH9-UAy.js";import"./Progress-DnTE48kW.js";import"./Label-BEoBeC8X.js";const h="/build/assets/bstr-black-down-Y0mw1zr6.svg",m="/build/assets/bstr-black-up-Cd1HoMj5.svg",x="/build/assets/bstr-gray-down-DfwarobR.svg",u="/build/assets/bstr-gray-up-DjpVTJQl.svg",p={day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1},z=({paginator:n})=>{const{brunches:C,filtersAndSort:l,routes:g}=w().props,y="/"+g.review_table_prefix+"/"+g.review,i=new URLSearchParams(window.location.search);i.delete("page"),console.log(l);const{data:s,setData:r,get:S,processing:D}=k({date:"date"in l&&Array.isArray(l.date)?l.date.map(t=>new Date(t)):[],brunches:"brunches"in l?C.filter(t=>l.brunches.map(Number).includes(t.value)):[],platform:"platform"in l?l.platform.map(t=>({label:t,value:t})):[],sort:l.sort??"",orderBy:l.orderBy??"",commit:!1});return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Отзывы"}),e.jsx(b,{}),e.jsxs(f,{fluid:!0,children:[e.jsx(_,{className:"my-3",children:e.jsxs(j,{children:[e.jsx("h2",{children:"Отзывы"}),e.jsxs(v,{color:"info",children:["Всего записей: ",n.total]}),e.jsx(f,{fluid:!0,className:"p-0",children:e.jsx(j,{xl:8,children:e.jsx($,{data:s,get:S,setData:r,processing:D})})})]})}),e.jsx(_,{className:"small",children:e.jsx(j,{children:e.jsxs(N,{responsive:!0,size:"sm",hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"#"}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{className:"mr-1",children:"Дата публикации отзыва"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="posted_at"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","posted_at"),r("orderBy","ASC"),r("commit",!0)}}),e.jsx("img",{src:s.sort==="posted_at"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","posted_at"),r("orderBy","DESC"),r("commit",!0)}})]})]}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{children:"Дата начала проверки"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="start_work_on"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","start_work_on"),r("orderBy","ASC"),r("commit",!0)}}),e.jsx("img",{src:s.sort==="start_work_on"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","start_work_on"),r("orderBy","DESC"),r("commit",!0),o.visit(y+"?column=start_work_on&orderBy=DESC")}})]})]}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{children:"Дата завершения проверки"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="end_work_on"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","end_work_on"),r("orderBy","ASC"),r("commit",!0)}}),e.jsx("img",{src:s.sort==="end_work_on"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","end_work_on"),r("orderBy","DESC"),r("commit",!0)}})]})]}),e.jsx("th",{children:"Платформа"}),e.jsx("th",{children:"Филиал"}),e.jsxs("th",{children:[e.jsx("div",{children:"Текущий рейтинг"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center",children:[e.jsx("img",{src:s.sort==="total_brunch_rate"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","total_brunch_rate"),r("orderBy","ASC"),r("commit",!0)}}),e.jsx("img",{src:s.sort==="total_brunch_rate"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","total_brunch_rate"),r("orderBy","DESC"),r("commit",!0)}})]})]}),e.jsxs("th",{children:[e.jsx("div",{children:"Оценка"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="score"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","score"),r("orderBy","ASC"),r("commit",!0)}}),e.jsx("img",{src:s.sort==="score"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:t=>{t.preventDefault(),r("sort","score"),r("orderBy","DESC"),r("commit",!0)}})]})]}),e.jsx("th",{className:"text-center",children:"Отправитель"}),e.jsx("th",{className:"col-3",children:"Отзыв"}),e.jsx("th",{className:"col-3",children:"Комментарий управляющего"}),e.jsx("th",{className:"col-3",children:"Ответ SMM на платформе"})]})}),e.jsx("tbody",{children:n.data.map((t,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.review_id},`review_id-${c}`),e.jsx("td",{children:new Date(t.posted_at.replace(/Z$/,"")).toLocaleString("ru-RU",p)},`posted_at-${c}`),e.jsx("td",{children:t.start_work_on?new Date(t.start_work_on).toLocaleString("ru-RU",p):"-"},`start_work_on-${c}`),e.jsx("td",{children:t.end_work_on?new Date(t.end_work_on).toLocaleString("ru-RU",p):"-"},`end_work_on-${c}`),e.jsx("td",{children:t.resource.toUpperCase()},`resource-${c}`),e.jsx("td",{children:t.brunch_name},`brunch_name-${c}`),e.jsx("td",{className:"text-center",children:t.total_brunch_rate},`total_brunch_rate-${c}`),e.jsx("td",{className:"text-center",children:e.jsx(v,{color:t.score<=3?"danger":t.score==4?"warning":"success",children:t.score})},`score-${c}`),e.jsx("td",{className:"text-center",children:t.sender},`sender-${c}`),e.jsx("td",{children:t.comment},`comment-${c}`),e.jsx("td",{children:t.control_review},`control_review-${c}`),e.jsx("td",{children:t.final_answer},`final_answer-${c}`)]}))})]})})}),e.jsx(_,{children:e.jsx(j,{className:" d-flex justify-content-center",children:e.jsxs(A,{className:" d-flex justify-content-center gap-3",children:[e.jsx(a,{children:e.jsx(d,{first:!0,href:n.first_page_url+"&"+i.toString(),onClick:t=>{t.preventDefault(),o.visit(n.first_page_url+"&"+i.toString())}})}),n.prev_page_url?e.jsx(a,{children:e.jsx(d,{previous:!0,href:n.prev_page_url+"&"+i.toString(),onClick:t=>{t.preventDefault(),o.visit(n.prev_page_url+"&"+i.toString())}})}):null,n.links.slice(1,n.links.length-1).map(t=>e.jsx(a,{disabled:!t.url,active:t.active,children:e.jsx(d,{className:t.active?"":"d-none d-sm-none d-md-none",href:t.url+"&"+i.toString(),onClick:c=>{c.preventDefault(),o.visit(t.url+"&"+i.toString())},children:t.label})})),n.next_page_url?e.jsx(a,{children:e.jsx(d,{next:!0,href:n.next_page_url+"&"+i.toString(),onClick:t=>{t.preventDefault(),o.visit(n.next_page_url+"&"+i.toString())}})}):null,e.jsx(a,{children:e.jsx(d,{last:!0,href:n.last_page_url+"&"+i.toString(),onClick:t=>{t.preventDefault(),o.visit(n.last_page_url+"&"+i.toString())}})})]})})})]})]})};export{z as default};
