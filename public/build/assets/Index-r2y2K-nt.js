import{J as w,x as k,j as e,S as c}from"./app-BmDeQ7V-.js";import{N as b}from"./NavBar-ByTnacCq.js";import{H as B}from"./Head-sasVaX65.js";import{C as f,R as _,a as j,A as v}from"./Alert-BMFFu7r-.js";import{T as N}from"./Table-DN_t0QhH.js";import{P as A,a,b as d}from"./PaginationLink-DU0E2Rxv.js";import{F as E}from"./Filter-VRbPhQew.js";import"./Progress-BRY5KVQQ.js";import"./Label-CmvS764P.js";const h="/build/assets/bstr-black-down-Y0mw1zr6.svg",m="/build/assets/bstr-black-up-Cd1HoMj5.svg",u="/build/assets/bstr-gray-down-DfwarobR.svg",x="/build/assets/bstr-gray-up-DjpVTJQl.svg",p={day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1},z=({paginator:n})=>{const{brunches:C,filtersAndSort:l,routes:g}=w().props,y="/"+g.review_table_prefix+"/"+g.review,o=new URLSearchParams(window.location.search);o.delete("page"),console.log(l);const{data:s,setData:t,get:S,processing:D}=k({date:"date"in l&&Array.isArray(l.date)?l.date.map(r=>new Date(r)):[],brunches:"brunches"in l?C.filter(r=>l.brunches.map(Number).includes(r.value)):[],platform:"platform"in l?l.platform.map(r=>({label:r,value:r})):[],sort:l.sort??"",orderBy:l.orderBy??"",commit:!1});return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Отзывы"}),e.jsx(b,{}),e.jsxs(f,{fluid:!0,children:[e.jsx(_,{className:"my-3",children:e.jsxs(j,{children:[e.jsx("h2",{children:"Отзывы"}),e.jsxs(v,{color:"info",children:["Всего записей: ",n.total]}),e.jsx(f,{fluid:!0,className:"p-0",children:e.jsx(j,{xl:8,children:e.jsx(E,{data:s,get:S,setData:t,processing:D})})})]})}),e.jsx(_,{className:"small",children:e.jsx(j,{children:e.jsxs(N,{responsive:!0,size:"sm",hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"#"}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{className:"mr-1",children:"Дата публикации отзыва"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="posted_at"&&s.orderBy==="ASC"?m:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","posted_at"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="posted_at"&&s.orderBy==="DESC"?h:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","posted_at"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{children:"Дата начала проверки"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="start_work_on"&&s.orderBy==="ASC"?m:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","start_work_on"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="start_work_on"&&s.orderBy==="DESC"?h:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","start_work_on"),t("orderBy","DESC"),t("commit",!0),c.visit(y+"?column=start_work_on&orderBy=DESC")}})]})]}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{children:"Дата завершения проверки"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="end_work_on"&&s.orderBy==="ASC"?m:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","end_work_on"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="end_work_on"&&s.orderBy==="DESC"?h:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","end_work_on"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsx("th",{children:"Платформа"}),e.jsx("th",{children:"Филиал"}),e.jsxs("th",{children:[e.jsx("div",{children:"Текущий рейтинг"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center",children:[e.jsx("img",{src:s.sort==="total_brunch_rate"&&s.orderBy==="ASC"?m:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","total_brunch_rate"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="total_brunch_rate"&&s.orderBy==="DESC"?h:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","total_brunch_rate"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsxs("th",{children:[e.jsx("div",{children:"Оценка"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="score"&&s.orderBy==="ASC"?m:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","score"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="score"&&s.orderBy==="DESC"?h:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","score"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsx("th",{className:"col-3",children:"Отзыв"}),e.jsx("th",{className:"col-3",children:"Комментарий управляющего"}),e.jsx("th",{className:"col-3",children:"Ответ SMM на платформе"})]})}),e.jsx("tbody",{children:n.data.map((r,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:r.review_id},`review_id-${i}`),e.jsx("td",{children:new Date(r.posted_at.replace(/Z$/,"")).toLocaleString("ru-RU",p)},`posted_at-${i}`),e.jsx("td",{children:r.start_work_on?new Date(r.start_work_on).toLocaleString("ru-RU",p):"-"},`start_work_on-${i}`),e.jsx("td",{children:r.end_work_on?new Date(r.end_work_on).toLocaleString("ru-RU",p):"-"},`end_work_on-${i}`),e.jsx("td",{children:r.resource.toUpperCase()},`resource-${i}`),e.jsx("td",{children:r.brunch_name},`brunch_name-${i}`),e.jsx("td",{className:"text-center",children:r.total_brunch_rate},`total_brunch_rate-${i}`),e.jsx("td",{className:"text-center",children:e.jsx(v,{color:r.score<=3?"danger":r.score==4?"warning":"success",children:r.score})},`score-${i}`),e.jsx("td",{children:r.comment},`comment-${i}`),e.jsx("td",{children:r.control_review},`control_review-${i}`),e.jsx("td",{children:r.final_answer},`final_answer-${i}`)]}))})]})})}),e.jsx(_,{children:e.jsx(j,{className:" d-flex justify-content-center",children:e.jsxs(A,{className:" d-flex justify-content-center gap-3",children:[e.jsx(a,{children:e.jsx(d,{first:!0,href:n.first_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),c.visit(n.first_page_url+"&"+o.toString())}})}),n.prev_page_url?e.jsx(a,{children:e.jsx(d,{previous:!0,href:n.prev_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),c.visit(n.prev_page_url+"&"+o.toString())}})}):null,n.links.slice(1,n.links.length-1).map(r=>e.jsx(a,{disabled:!r.url,active:r.active,children:e.jsx(d,{className:r.active?"":"d-none d-sm-none d-md-none",href:r.url+"&"+o.toString(),onClick:i=>{i.preventDefault(),c.visit(r.url+"&"+o.toString())},children:r.label})})),n.next_page_url?e.jsx(a,{children:e.jsx(d,{next:!0,href:n.next_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),c.visit(n.next_page_url+"&"+o.toString())}})}):null,e.jsx(a,{children:e.jsx(d,{last:!0,href:n.last_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),c.visit(n.last_page_url+"&"+o.toString())}})})]})})})]})]})};export{z as default};
