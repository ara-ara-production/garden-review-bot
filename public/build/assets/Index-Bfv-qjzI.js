import{J as w,x as b,j as e,S as i}from"./app-ZNc4aQxL.js";import{N as k}from"./NavBar-BUpFte5n.js";import{H as B}from"./Head-C1rHtqH9.js";import{C as f,R as _,a as j,A as v,B as N}from"./Alert-BmcET3X7.js";import{T as A}from"./Table-DVB8HkD_.js";import{P as $,a,b as d}from"./PaginationLink-BVQl5EOp.js";import{U as E,F as U}from"./Filter-CpyfKyAT.js";import"./Progress-3MOQINUM.js";import"./Label-fs6ezNmB.js";const h="/build/assets/bstr-black-down-Y0mw1zr6.svg",m="/build/assets/bstr-black-up-Cd1HoMj5.svg",x="/build/assets/bstr-gray-down-DfwarobR.svg",u="/build/assets/bstr-gray-up-DjpVTJQl.svg",g={day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1},I=({paginator:n})=>{const{brunches:C,filtersAndSort:c,routes:p}=w().props,y="/"+p.review_table_prefix+"/"+p.review,o=new URLSearchParams(window.location.search);o.delete("page"),console.log(c);const{data:s,setData:t,get:S,processing:D}=b({date:"date"in c&&Array.isArray(c.date)?c.date.map(r=>new Date(r)):[],brunches:"brunches"in c?C.filter(r=>c.brunches.map(Number).includes(r.value)):[],platform:"platform"in c?c.platform.map(r=>({label:r,value:r})):[],sort:c.sort??"",orderBy:c.orderBy??"",commit:!1});return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Отзывы"}),e.jsx(k,{}),e.jsxs(f,{fluid:!0,children:[e.jsx(_,{className:"my-3",children:e.jsxs(j,{children:[e.jsx("h2",{children:"Отзывы"}),e.jsxs(v,{color:"info",children:["Всего записей: ",n.total]}),e.jsx(f,{fluid:!0,className:"p-0",children:e.jsxs(j,{xl:8,children:[e.jsx(N,{className:"w-100 m-0 mb-1",color:"primary",id:"toggler",children:"Фильтр"}),e.jsx(E,{toggler:"#toggler",children:e.jsx(U,{data:s,get:S,setData:t,processing:D})})]})})]})}),e.jsx(_,{className:"small",children:e.jsx(j,{children:e.jsxs(A,{responsive:!0,size:"sm",hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"#"}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{className:"mr-1",children:"Дата публикации отзыва"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="posted_at"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","posted_at"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="posted_at"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","posted_at"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{children:"Дата начала проверки"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="start_work_on"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","start_work_on"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="start_work_on"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","start_work_on"),t("orderBy","DESC"),t("commit",!0),i.visit(y+"?column=start_work_on&orderBy=DESC")}})]})]}),e.jsxs("th",{className:"col-1",children:[e.jsx("div",{children:"Дата завершения проверки"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="end_work_on"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","end_work_on"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="end_work_on"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","end_work_on"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsx("th",{children:"Платформа"}),e.jsx("th",{children:"Филиал"}),e.jsxs("th",{children:[e.jsx("div",{children:"Текущий рейтинг"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center",children:[e.jsx("img",{src:s.sort==="total_brunch_rate"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","total_brunch_rate"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="total_brunch_rate"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","total_brunch_rate"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsxs("th",{children:[e.jsx("div",{children:"Оценка"}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("img",{src:s.sort==="score"&&s.orderBy==="ASC"?m:u,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","score"),t("orderBy","ASC"),t("commit",!0)}}),e.jsx("img",{src:s.sort==="score"&&s.orderBy==="DESC"?h:x,width:15,height:15,onClick:r=>{r.preventDefault(),t("sort","score"),t("orderBy","DESC"),t("commit",!0)}})]})]}),e.jsx("th",{className:"text-center",children:"Отправитель"}),e.jsx("th",{className:"col-3",children:"Отзыв"}),e.jsx("th",{className:"col-3",children:"Комментарий управляющего"}),e.jsx("th",{className:"col-3",children:"Ответ SMM на платформе"})]})}),e.jsx("tbody",{children:n.data.map((r,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:r.review_id},`review_id-${l}`),e.jsx("td",{children:new Date(r.posted_at.replace(/Z$/,"")).toLocaleString("ru-RU",g)},`posted_at-${l}`),e.jsx("td",{children:r.start_work_on?new Date(r.start_work_on).toLocaleString("ru-RU",g):"-"},`start_work_on-${l}`),e.jsx("td",{children:r.end_work_on?new Date(r.end_work_on).toLocaleString("ru-RU",g):"-"},`end_work_on-${l}`),e.jsx("td",{children:r.resource.toUpperCase()},`resource-${l}`),e.jsx("td",{children:r.brunch_name},`brunch_name-${l}`),e.jsx("td",{className:"text-center",children:r.total_brunch_rate},`total_brunch_rate-${l}`),e.jsx("td",{className:"text-center",children:e.jsx(v,{color:r.score<=3?"danger":r.score==4?"warning":"success",children:r.score})},`score-${l}`),e.jsx("td",{className:"text-center",children:r.sender},`sender-${l}`),e.jsx("td",{children:r.comment},`comment-${l}`),e.jsx("td",{children:r.control_review},`control_review-${l}`),e.jsx("td",{children:r.final_answer},`final_answer-${l}`)]}))})]})})}),e.jsx(_,{children:e.jsx(j,{className:" d-flex justify-content-center",children:e.jsxs($,{className:" d-flex justify-content-center gap-3",children:[e.jsx(a,{children:e.jsx(d,{first:!0,href:n.first_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),i.visit(n.first_page_url+"&"+o.toString())}})}),n.prev_page_url?e.jsx(a,{children:e.jsx(d,{previous:!0,href:n.prev_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),i.visit(n.prev_page_url+"&"+o.toString())}})}):null,n.links.slice(1,n.links.length-1).map(r=>e.jsx(a,{disabled:!r.url,active:r.active,children:e.jsx(d,{className:r.active?"":"d-none d-sm-none d-md-none",href:r.url+"&"+o.toString(),onClick:l=>{l.preventDefault(),i.visit(r.url+"&"+o.toString())},children:r.label})})),n.next_page_url?e.jsx(a,{children:e.jsx(d,{next:!0,href:n.next_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),i.visit(n.next_page_url+"&"+o.toString())}})}):null,e.jsx(a,{children:e.jsx(d,{last:!0,href:n.last_page_url+"&"+o.toString(),onClick:r=>{r.preventDefault(),i.visit(n.last_page_url+"&"+o.toString())}})})]})})})]})]})};export{I as default};
